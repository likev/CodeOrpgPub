/*
 * RCS info
 * $Author: ccalvert $
 * $Locker:  $
 * $Date: 2011/04/13 22:53:06 $
 * $Id: gauge_radar_location.c,v 1.3 2011/04/13 22:53:06 ccalvert Exp $
 * $Revision: 1.3 $
 * $State: Exp $
 */

/* This file contains location of all the gauges
 *
 * RPGCS_latlon_to_azran() was used to convert gauge (lat, lon)
 * into (azm, bin) values
*************************************************************************/

#include "siteadp.h"            /* Siteadp_adpt_t */
#include "gauge_radar_types.h"  /* Gauge          */

extern Siteadp_adpt_t site_adapt; /* site adaptation data */
extern Gauge gauges[MAX_GAUGES];
extern short num_gauges;

/* This is only useful if the radar is KOUN
#define KOUN_GAUGES 165

char* koun_gauge_name[KOUN_GAUGES] = {
 "ADAX",   "ALTU",   "ANTL",   "BESS",   "BIXB",
 "BLAC",   "BOWL",   "BREC",   "BRIS",   "BURB",
 "BURN",   "BUTL",   "BYAR",   "CAMA",   "CENT",
 "CHAN",   "CHER",   "CHEY",   "CHIC",   "CLAY",
 "DURA",   "ELRE",   "ERIC",   "EUFA",   "FAIR",
 "FORA",   "FREE",   "FTCB",   "GUTH",   "HASK",
 "HINT",   "HOBA",   "HOLL",   "HUGO",   "KETC",
 "LAHO",   "LANE",   "MADI",   "MANG",   "MARE",
 "MCAL",   "MEDF",   "MEDI",   "MINC",   "NEWK",
 "OILT",   "OKEM",   "OKMU",   "PAUL",   "PAWN",
 "PERK",   "PUTN",   "REDR",   "RETR",   "RING",
 "SEIL",   "SHAW",   "SKIA",   "SPEN",   "STIG",
 "STIL",   "STUA",   "SULP",   "TIPT",   "TISH",
 "WALT",   "WASH",   "WATO",   "WAUR",   "WEAT",
 "WILB",   "WOOD",   "WYNO",   "NINN",   "ACME",
 "APAC",   "HECT",   "VANO",   "ALV2",   "GRA2",
 "PORT",   "INOL",   "CLRM",   "NEWP",
 "MRSH",   "ARD2",   "FITT",   "OKCN",   "OKCW",
 "OKCE",   "CARL",   "WEBR",   "KIN2",   "HOLD",
 "A121",   "A124",   "A131",   "A132",   "A133",
 "A134",   "A135",   "A136",   "A144",   "A146",
 "A148",   "A149",   "A150",   "A152",   "A153",
 "A154",   "A156",   "A159",   "A162",   "A182",
 "F115",   "F108",   "F105",   "F102",   "F113",
 "F101",   "F104",   "F114",   "F111",   "F107",
 "F106",   "F109",   "F110",   "F112",   "F103",
 "KCB101", "KCB102", "KCB103", "KCB104", "KCB105",
 "KCB106", "KCB107", "KCB108", "KCB109", "KCB110",
 "KNE101", "KNE103", "KNE104", "KNE105", "KNE202",
 "KNW103", "KNW104", "KNW105", "KNW106", "KNW107",
 "KNW108", "KNW201", "KNW202", "KSE101", "KSE102",
 "KSW101", "KSW102", "KSW103", "KSW104", "KSW105",
 "KSW107", "KSW108", "KSW109", "KSW110", "KSW111",
 "KSW112"};

float koun_gauge_lat[KOUN_GAUGES] = {
 34.798512, 34.587219, 34.224380, 35.401852, 35.963051,
 36.754429, 35.171558, 36.412010, 35.780499, 36.634590,
 33.893761, 35.591499, 34.849701, 36.028660, 34.608959,
 35.652821, 36.748131, 35.546150, 35.032360, 34.656570,
 33.920750, 35.548481, 35.204941, 35.303242, 36.263531,
 36.840530, 36.725620, 35.148869, 35.848911, 35.747978,
 35.484390, 34.989712, 34.685501, 34.030842, 34.528870,
 36.384350, 34.308762, 34.035789, 34.835918, 36.064339,
 34.882309, 36.792419, 34.729210, 35.272251, 36.898102,
 36.031261, 35.431721, 35.582111, 34.715500, 36.361141,
 35.998650, 35.899040, 36.355900, 35.122749, 34.193649,
 36.190331, 35.364922, 36.415298, 35.542080, 35.265270,
 36.120930, 34.876419, 34.566101, 34.439720, 34.332619,
 34.364700, 34.982239, 35.841850, 34.167751, 35.508301,
 34.900921, 36.423290, 36.518059, 34.967739, 34.808331,
 34.914181, 35.841621, 34.791458, 36.708229, 34.239201,
 35.825699, 36.142460, 36.321121, 34.228100,
 36.116852, 34.192581, 34.552052, 35.555599, 35.471119,
 35.472260, 36.147301, 35.488998, 35.854309, 35.070728,
 34.958599, 34.972801, 34.950298, 34.942799, 34.949200,
 34.936699, 34.927200, 34.927799, 34.878899, 34.885300,
 34.899200, 34.898300, 34.906101, 34.861099, 34.855301,
 34.855301, 34.843102, 34.796700, 34.807499, 34.845001,
 35.229401, 35.361099, 35.407200, 35.450401, 35.291000,
 35.455101, 35.392300, 35.283001, 35.334301, 35.376400,
 35.391499, 35.312302, 35.330299, 35.305099, 35.423698,
 35.472912, 35.472057, 35.469734, 35.469685, 35.467941,
 35.467602, 35.467442, 35.466564, 35.464104, 35.464394,
 35.551014, 35.493237, 35.478127, 35.525356, 35.488194,
 35.565582, 35.542019, 35.522243, 35.511120, 35.500217,
 35.482288, 35.613613, 35.580227, 35.435108, 35.415516,
 35.464428, 35.458721, 35.464355, 35.448158, 35.449650,
 35.420853, 35.406113, 35.398872, 35.392536, 35.387604,
 35.343349};

float koun_gauge_lon[KOUN_GAUGES] = {
 -96.669090, -99.338081, -95.700592, -99.058472, -95.866211,
 -97.254517, -96.631210, -97.693939, -96.354042, -96.810463,
 -97.269180, -99.270592, -97.003304, -99.346519, -96.333092,
 -96.804070, -98.362740, -99.727898, -97.914459, -95.325958,
 -96.320267, -98.036537, -99.803436, -95.657066, -98.497658,
 -96.427773, -99.142342, -98.466072, -97.479782, -95.640472,
 -98.481506, -99.052834, -99.833313, -95.540108, -97.764839,
 -98.111389, -95.997162, -96.943939, -99.423981, -97.212708,
 -95.780960, -97.745773, -98.569359, -97.955528, -96.910347,
 -96.497490, -96.262650, -95.914726, -97.229240, -96.769859,
 -97.048309, -98.960381, -97.153061, -99.360008, -97.588120,
 -99.040298, -96.948219, -96.037064, -97.341461, -95.181160,
 -97.095268, -96.069817, -96.950478, -99.137550, -96.678947,
 -98.320251, -97.521088, -98.526154, -97.988152, -98.775093,
 -95.348053, -99.416817, -96.342216, -97.952019, -98.023247,
 -98.292160, -96.002403, -96.843811, -98.709740, -98.744400,
 -95.559761, -95.450668, -95.646172, -97.201424,
 -97.606850, -97.085678, -96.717789, -97.510696, -97.582451,
 -97.464142, -97.285851, -95.123299, -97.954422, -96.355949,
 -97.898598, -98.058098, -98.233597, -98.181900, -98.128098,
 -98.075302, -98.019699, -97.965599, -97.917198, -98.023102,
 -98.128098, -98.180801, -98.251099, -98.251099, -98.199997,
 -98.136902, -97.958298, -97.993301, -98.141403, -98.073097,
 -98.606300, -98.571198, -98.570999, -98.544296, -98.635696,
 -98.606400, -98.623299, -98.437103, -98.438400, -98.464996,
 -98.513802, -98.567497, -98.520203, -98.491402, -98.708702,
 -97.510170, -97.517845, -97.516495, -97.514259, -97.521393,
 -97.516197, -97.512604, -97.514648, -97.516136, -97.500961,
 -97.476830, -97.459259, -97.499107, -97.473808, -97.503662,
 -97.567307, -97.654228, -97.534309, -97.609940, -97.565475,
 -97.529793, -97.549316, -97.638741, -97.477020, -97.423508,
 -97.760132, -97.618980, -97.547691, -97.583427, -97.506958,
 -97.554695, -97.599976, -97.507774, -97.665176, -97.565681,
 -97.529770};

float koun_gauge_azm[KOUN_GAUGES] = {
 123.740379, 247.673203, 124.442520, 277.716919,  60.274113,
   6.247849,  95.183189, 350.982208,  58.559097,  20.475533,
 173.198532, 284.082764, 135.676819, 297.908661, 123.790596,
  51.939247, 334.531372, 280.186218, 241.304489, 107.697266,
 144.120026, 303.876251, 269.745117,  86.866486, 321.018433,
  27.226227, 318.100372, 264.228149, 358.652832,  70.427422,
 286.927979, 259.741272, 254.866028, 126.762123, 199.444016,
 335.553406, 127.198639, 160.300018, 256.579742,  13.669624,
 103.931236, 351.693817, 241.131577, 275.282318,  14.856152,
  44.308231,  78.341644,  74.205399, 159.809326,  26.314743,
  23.675430, 298.980377,  12.522284, 266.371887, 185.715820,
 307.133636,  72.761162,  43.996986,  17.764505,  88.441559,
  18.498251, 107.111145, 147.796707, 240.409332, 144.328522,
 219.213318, 190.801651, 305.287231, 202.194534, 284.648346,
 100.351974, 307.407104,  34.960949, 236.352707, 227.223724,
 244.892990,  62.559719, 131.105789, 325.918549, 226.960220,
  68.595680,  60.390614,  53.096489, 167.930359,
 352.433594, 163.379318, 138.038269, 352.933929, 337.358276,
 359.576996,   8.870628,  81.767906, 327.199707, 100.038200,
 232.293915, 241.815628, 245.873703, 243.745758, 242.437408,
 239.365234, 236.077347, 233.353638, 226.348801, 232.796951,
 238.485046, 240.350891, 243.168533, 240.098938, 237.997498,
 235.627289, 226.106674, 224.879410, 232.593674, 232.168976,
 269.925537, 278.188049, 281.034088, 283.963043, 273.623413,
 283.539886, 279.701385, 273.659637, 277.312927, 280.022766,
 280.572998, 275.151489, 276.535522, 274.997253, 280.815918,
 350.598297, 349.095245, 349.249115, 349.678253, 348.220367,
 349.210022, 349.903290, 349.465118, 349.060120, 352.090149,
 357.806580,   0.497058, 352.886292, 358.097748, 352.339264,
 345.432465, 332.938690, 348.382660, 336.367218, 342.318817,
 347.367371, 349.354401, 337.342865, 356.482758,   9.911941,
 313.296204, 330.150757, 343.007050, 335.008728, 350.273224,
 337.776733, 326.543945, 347.097412, 313.414093, 330.865234,
 332.757751};

int koun_gauge_azm_i[KOUN_GAUGES] = {
 123, 247, 124, 277,  60,
   6,  95, 350,  58,  20,
 173, 284, 135, 297, 123,
  51, 334, 280, 241, 107,
 144, 303, 269,  86, 321,
  27, 318, 264, 358,  70,
 286, 259, 254, 126, 199,
 335, 127, 160, 256,  13,
 103, 351, 241, 275,  14,
  44,  78,  74, 159,  26,
  23, 298,  12, 266, 185,
 307,  72,  43,  17,  88,
  18, 107, 147, 240, 144,
 219, 190, 305, 202, 284,
 100, 307,  34, 236, 227,
 244,  62, 131, 325, 226,
  68,  60,  53, 167,
 352, 163, 138, 352, 337,
 359,   8,  81, 327, 100,
 232, 241, 245, 243, 242,
 239, 236, 233, 226, 232,
 238, 240, 243, 240, 237,
 235, 226, 224, 232, 232,
 269, 278, 281, 283, 273,
 283, 279, 273, 277, 280,
 280, 275, 276, 274, 280,
 350, 349, 349, 349, 348,
 349, 349, 349, 349, 352,
 357,   0, 352, 358, 352,
 345, 332, 348, 336, 342,
 347, 349, 337, 356,   9,
 313, 330, 343, 335, 350,
 337, 326, 347, 313, 330,
 332};

float koun_gauge_km[KOUN_GAUGES] = {
  87.210426, 186.003723, 196.744278, 146.278503, 165.688873,
 170.185928,  75.947578, 132.663589, 117.350494, 166.517776,
 150.564316, 168.909042,  60.002804, 192.129593, 124.535255,
  75.624580, 187.000961, 208.670746,  47.037361, 205.462891,
 180.097778,  62.707218, 213.129333, 164.331131, 147.877991,
 201.577332, 224.698578,  91.907875,  68.282097, 174.783356,
  96.652229, 147.535812, 225.029999, 221.502914,  83.478874,
 140.729385, 169.223419, 141.878281, 184.429306,  94.981621,
 158.268951, 175.264526, 115.757751,  45.064053, 191.715149,
 124.385902, 111.142586, 145.672836,  61.738750, 140.068222,
  92.837563, 154.562546, 127.832062, 173.280228, 116.679123,
 177.996292,  48.855824, 183.915771,  35.800140, 207.533020,
 104.003220, 133.114243,  88.037300, 177.030731, 123.522430,
 124.827972,  28.767544, 117.717537, 128.378998, 123.062210,
 196.332901, 220.617355, 174.970779,  53.722099,  69.923180,
  83.731354, 148.511765,  75.042023, 198.886261, 161.591171,
 184.544281, 208.130890, 203.832520, 114.774368,
  98.984352, 121.226311, 102.108757,  35.865559,  28.377005,
  26.310923, 102.748520, 214.340546,  82.061104, 102.395744,
  50.369595,  61.718662,  77.181297,  73.285362,  68.592606,
  65.079041,  61.370667,  57.312805,  57.479225,  64.359558,
  71.372536,  75.553108,  80.772697,  83.190277,  79.538422,
  74.732849,  62.951626,  68.865616,  78.216827,  70.722420,
 104.112137, 101.791504, 102.574776, 101.191551, 106.919815,
 106.799812, 106.976654,  88.837593,  89.445831,  92.499687,
  97.152893, 100.885605,  96.786278,  93.925789, 115.205956,
  26.743176,  26.772587,  26.495413,  26.452799,  26.386641,
  26.257074,  26.180273,  26.117456,  25.873468,  25.679207,
  35.107178,  28.647522,  27.173435,  32.241558,  28.338533,
  37.928459,  38.288696,  32.546227,  33.454102,  30.888065,
  28.109755,  42.793674,  41.556744,  22.214642,  20.294378,
  37.154678,  28.609385,  26.594473,  26.074259,  24.140141,
  22.241278,  22.716402,  18.608059,  25.391815,  19.333498,
  13.447857};

int koun_gauge_dp_bin[KOUN_GAUGES] = {
 348,  744,  786,  585,  662,
 680,  303,  530,  469,  666,
 602,  675,  240,  768,  498,
 302,  748,  834,  188,  821,
 720,  250,  852,  657,  591,
 806,  898,  367,  273,  699,
 386,  590,  900,  886,  333,
 562,  676,  567,  737,  379,
 633,  701,  463,  180,  766,
 497,  444,  582,  246,  560,
 371,  618,  511,  693,  466,
 711,  195,  735,  143,  830,
 416,  532,  352,  708,  494,
 499,  115,  470,  513,  492,
 785,  882,  699,  214,  279,
 334,  594,  300,  795,  646,
 738,  832,  815,  459,
 395,  484,  408,  143,  113,
 105,  410,  857,  328,  409,
 201,  246,  308,  293,  274,
 260,  245,  229,  229,  257,
 285,  302,  323,  332,  318,
 298,  251,  275,  312,  282,
 416,  407,  410,  404,  427,
 427,  427,  355,  357,  369,
 388,  403,  387,  375,  460,
 106,  107,  105,  105,  105,
 105,  104,  104,  103,  102,
 140,  114,  108,  128,  113,
 151,  153,  130,  133,  123,
 112,  171,  166,   88,   81,
 148,  114,  106,  104,   96,
  88,   90,   74,  101,   77,
  53};

int koun_gauge_pps_bin[KOUN_GAUGES] = {
  43,  93,  98,  73,  82,
  85,  37,  66,  58,  83,
  75,  84,  30,  96,  62,
  37,  93, 104,  23, 102,
  90,  31, 106,  82,  73,
 100, 112,  45,  34,  87,
  48,  73, 112, 110,  41,
  70,  84,  70,  92,  47,
  79,  87,  57,  22,  95,
  62,  55,  72,  30,  70,
  46,  77,  63,  86,  58,
  88,  24,  91,  17, 103,
  52,  66,  44,  88,  61,
  62,  14,  58,  64,  61,
  98, 110,  87,  26,  34,
  41,  74,  37,  99,  80,
  92, 104, 101,  57,
  49,  60,  51,  17,  14,
  13,  51, 107,  41,  51,
  25,  30,  38,  36,  34,
  32,  30,  28,  28,  32,
  35,  37,  40,  41,  39,
  37,  31,  34,  39,  35,
  52,  50,  51,  50,  53,
  53,  53,  44,  44,  46,
  48,  50,  48,  46,  57,
  13,  13,  13,  13,  13,
  13,  13,  13,  12,  12,
  17,  14,  13,  16,  14,
  18,  19,  16,  16,  15,
  14,  21,  20,  11,  10,
  18,  14,  13,  13,  12,
  11,  11,   9,  12,   9,
   6};

-* koun_gauge_x and koun_gauge_y are 1/4 Km coordinates *-

short koun_gauge_x[KOUN_GAUGES] = {
  290, -688,  649, -580,  576,
   74,  303,  -83,  400,  233,
   71, -655,  168, -679,  414,
  238, -322, -822, -165,  783,
  422, -208, -853,  656, -372,
  369, -600, -366,   -6,  659,
 -370, -581, -869,  710, -111,
 -233,  539,  191, -718,   90,
  614, -101, -405, -179,  197,
  348,  435,  561,   85,  248,
  149, -541,  111, -692,  -46,
 -568,  187,  511,   44,  830,
  132,  509,  188, -616,  288,
 -316,  -22, -384, -194, -476,
  773, -701,  401, -179, -205,
 -303,  527,  226, -446, -472,
  687,  724,  652,   96,
  -52,  139,  273,  -18,  -44,
   -1,   63,  849, -178,  403,
 -159, -218, -282, -263, -243,
 -224, -204, -184, -166, -205,
 -243, -263, -288, -288, -270,
 -247, -181, -194, -249, -223,
 -416, -403, -403, -393, -427,
 -415, -422, -355, -355, -364,
 -382, -402, -385, -374, -453,
  -17,  -20,  -20,  -19,  -22,
  -20,  -18,  -19,  -20,  -14,
   -5,    1,  -13,   -4,  -15,
  -38,  -70,  -26,  -54,  -38,
  -25,  -32,  -64,   -5,   14,
 -108,  -57,  -31,  -44,  -16,
  -34,  -50,  -17,  -74,  -38,
  -25};

short koun_gauge_y[KOUN_GAUGES] = {
 -194, -283, -445,   79,  329,
  677,  -27,  524,  245,  624,
 -598,  164, -172,  360, -277,
  186,  675,  148,  -90, -250,
 -584,  140,   -4,   36,  460,
  717,  669,  -37,  273,  234,
  113, -105, -235, -530, -315,
  512, -409, -534, -171,  369,
 -152,  694, -224,   17,  741,
  356,   90,  159, -232,  502,
  340,  300,  499,  -44, -464,
  430,   58,  529,  136,   23,
  395, -157, -298, -350, -401,
 -387, -113,  272, -475,  124,
 -141,  536,  574, -119, -190,
 -142,  274, -197,  659, -441,
  269,  411,  490, -449,
  392, -465, -304,  142,  105,
  105,  406,  123,  276,  -71,
 -123, -117, -126, -130, -127,
 -133, -137, -137, -159, -156,
 -149, -150, -146, -166, -169,
 -169, -175, -195, -190, -174,
   -1,   58,   79,   98,   27,
  100,   72,   23,   46,   64,
   71,   36,   44,   33,   86,
  106,  105,  104,  104,  103,
  103,  103,  103,  102,  102,
  140,  115,  108,  129,  112,
  147,  136,  128,  123,  118,
  110,  168,  153,   89,   80,
  102,   99,  102,   95,   95,
   82,   76,   73,   70,   68,
   48};
*/

#define NUM_SITE_CHARS    6
#define NUM_LAT_CHARS     9
#define NUM_LNG_CHARS    11

#ifdef TEST_MASTER_LIST
#define NUM_MASTER_LIST 194
char* master_list[NUM_MASTER_LIST] = {
"KOUN   35.236058  -97.462350",
"KCRI   35.238333  -97.460000",
"KTLX   35.333056  -97.277761",
"KCB101 35.472910  -97.510168",
"KCB102 35.472057  -97.517848",
"KCB103 35.469736  -97.516492",
"KCB104 35.469683  -97.514260",
"KCB105 35.467943  -97.521393",
"KCB106 35.467601  -97.516195",
"KCB107 35.467440  -97.512603",
"KCB108 35.466565  -97.514651",
"KCB109 35.464103  -97.516135",
"KCB110 35.464394  -97.500963",
"KNE101 35.551014  -97.476827",
"KNE103 35.493238  -97.459257",
"KNE104 35.478127  -97.499108",
"KNE105 35.525356  -97.473806",
"KNE202 35.488195  -97.503662",
"KNW103 35.565581  -97.567309",
"KNW104 35.542018  -97.654226",
"KNW105 35.522242  -97.534311",
"KNW106 35.511119  -97.609936",
"KNW107 35.500216  -97.565475",
"KNW108 35.482289  -97.529792",
"KNW201 35.613612  -97.549314",
"KNW202 35.580225  -97.638741",
"KSE101 35.435109  -97.477019",
"KSE102 35.415515  -97.423511",
"KSW101 35.464427  -97.760130",
"KSW102 35.458720  -97.618981",
"KSW103 35.464357  -97.547689",
"KSW104 35.448157  -97.583425",
"KSW105 35.449649  -97.506961",
"KSW107 35.420851  -97.554698",
"KSW108 35.406112  -97.599975",
"KSW109 35.398874  -97.507771",
"KSW110 35.392538  -97.665177",
"KSW111 35.387602  -97.565685",
"KSW112 35.343350  -97.529770",
"A121   34.958600  -97.898600",
"A124   34.972800  -98.058100",
"A131   34.950300  -98.233600",
"A132   34.942800  -98.181900",
"A133   34.949200  -98.128100",
"A134   34.936700  -98.075300",
"A135   34.927200  -98.019700",
"A136   34.927800  -97.965600",
"A144   34.878900  -97.917200",
"A146   34.885300  -98.023100",
"A148   34.899200  -98.128100",
"A149   34.898300  -98.180800",
"A150   34.906100  -98.251100",
"A152   34.861100  -98.251100",
"A153   34.855300  -98.200000",
"A154   34.855300  -98.136900",
"A156   34.843100  -97.958300",
"A159   34.796700  -97.993300",
"A162   34.807500  -98.141400",
"A182   34.845000  -98.073100",
"F101   35.455100  -98.606400",
"F102   35.450400  -98.544300",
"F103   35.423700  -98.708700",
"F104   35.392300  -98.623300",
"F105   35.407200  -98.571000",
"F106   35.391500  -98.513800",
"F107   35.376400  -98.465000",
"F108   35.361100  -98.571200",
"F109   35.312300  -98.567500",
"F110   35.330300  -98.520200",
"F111   35.334300  -98.438400",
"F112   35.305100  -98.491400",
"F113   35.291000  -98.635700",
"F114   35.283000  -98.437100",
"F115   35.229400  -98.606300",
"ACME   34.808330  -98.023250",
"ADAX   34.798510  -96.669090",
"ALTU   34.587220  -99.338080",
"ALV2   36.708230  -98.709740",
"ANTL   34.224380  -95.700590",
"APAC   34.914180  -98.292160",
"ARD2   34.192580  -97.085680",
"ARNE   36.072040  -99.903080",
"BEAV   36.802530 -100.530120",
"BESS   35.401850  -99.058470",
"BIXB   35.963050  -95.866210",
"BLAC   36.754430  -97.254520",
"BOIS   36.692560 -102.497130",
"BOWL   35.171560  -96.631210",
"BREC   36.412010  -97.693940",
"BRIS   35.780500  -96.354040",
"BROK   34.043300  -94.624400",
"BUFF   36.831290  -99.641010",
"BURB   36.634590  -96.810460",
"BURN   33.893760  -97.269180",
"BUTL   35.591500  -99.270590",
"BYAR   34.849700  -97.003300",
"CAMA   36.028660  -99.346520",
"CARL   36.147300  -97.285850",
"CENT   34.608960  -96.333090",
"CHAN   35.652820  -96.804070",
"CHER   36.748130  -98.362740",
"CHEY   35.546150  -99.727900",
"CHIC   35.032360  -97.914460",
"CLAY   34.656570  -95.325960",
"CLOU   34.223210  -95.248700",
"CLRM   36.321120  -95.646170",
"COOK   35.680010  -94.848960",
"COPA   36.909870  -95.885530",
"DURA   33.920750  -96.320270",
"ELRE   35.548480  -98.036540",
"ERIC   35.204940  -99.803440",
"EUFA   35.303240  -95.657070",
"FAIR   36.263530  -98.497660",
"FITT   34.552050  -96.717790",
"FORA   36.840530  -96.427770",
"FREE   36.725620  -99.142340",
"FTCB   35.148870  -98.466070",
"GOOD   36.601830 -101.601300",
"GRA2   34.239200  -98.744400",
"GUTH   35.848910  -97.479780",
"HASK   35.747980  -95.640470",
"HECT   35.841620  -96.002400",
"HINT   35.484390  -98.481510",
"HOBA   34.989710  -99.052830",
"HOLD   35.070730  -96.355950",
"HOLL   34.685500  -99.833310",
"HOOK   36.855180 -101.225470",
"HUGO   34.030840  -95.540110",
"IDAB   33.830130  -94.880300",
"INOL   36.142460  -95.450670",
"JAYX   36.482100  -94.782870",
"KENT   36.829370 -102.878200",
"KETC   34.528870  -97.764840",
"KIN2   35.854310  -97.954420",
"LAHO   36.384350  -98.111390",
"LANE   34.308760  -95.997160",
"MADI   34.035790  -96.943940",
"MANG   34.835920  -99.423980",
"MARE   36.064340  -97.212710",
"MAYR   36.987070  -99.011090",
"MCAL   34.882310  -95.780960",
"MEDF   36.792420  -97.745770",
"MEDI   34.729210  -98.569360",
"MIAM   36.888320  -94.844370",
"MINC   35.272250  -97.955530",
"MRSH   36.116850  -97.606850",
"MTHE   34.310720  -94.822750",
"NEWK   36.898100  -96.910350",
"NEWP   34.228100  -97.201420",
"NINN   34.967740  -97.952020",
"NOWA   36.743740  -95.607950",
"NRMN   35.236110  -97.464880",
"OILT   36.031260  -96.497490",
"OKCE   35.472260  -97.464140",
"OKCN   35.555600  -97.510700",
"OKCW   35.471120  -97.582450",
"OKEM   35.431720  -96.262650",
"OKMU   35.582110  -95.914730",
"PAUL   34.715500  -97.229240",
"PAWN   36.361140  -96.769860",
"PERK   35.998650  -97.048310",
"PORT   35.825700  -95.559760",
"PRYO   36.369140  -95.271380",
"PUTN   35.899040  -98.960380",
"REDR   36.355900  -97.153060",
"RETR   35.122750  -99.360010",
"RING   34.193650  -97.588120",
"SALL   35.438150  -94.798050",
"SEIL   36.190330  -99.040300",
"SHAW   35.364920  -96.948220",
"SKIA   36.415300  -96.037060",
"SLAP   36.597490 -100.261920",
"SPEN   35.542080  -97.341460",
"STIG   35.265270  -95.181160",
"STIL   36.120930  -97.095270",
"STUA   34.876420  -96.069820",
"SULP   34.566100  -96.950480",
"TAHL   35.972350  -94.986710",
"TALI   34.710700  -95.011520",
"TIPT   34.439720  -99.137550",
"TISH   34.332620  -96.678950",
"VANO   34.791460  -96.843810",
"VINI   36.775360  -95.220940",
"WALT   34.364700  -98.320250",
"WASH   34.982240  -97.521090",
"WATO   35.841850  -98.526150",
"WAUR   34.167750  -97.988150",
"WEAT   35.508300  -98.775090",
"WEBR   35.489000  -95.123300",
"WEST   36.011000  -94.644960",
"WILB   34.900920  -95.348050",
"WIST   34.984260  -94.687780",
"WOOD   36.423290  -99.416820",
"WYNO   36.518060  -96.342220"};
#endif

#include <math.h>
#include <stdio.h>
#include <string.h>       /* memset                */
#include <stdlib.h>       /* atof                  */
#include <rpgcs_latlon.h> /* RPGCS_latlon_to_azran */

/******************************************************************************
   Function name: check_gauge_lat_lon()

   Description:
   ============
     Checks KOUN gauge lat/lons against tables of values

   Inputs:

     None.

   Outputs:

     None.

   Return:

      None.

   Called by: main() debug

   Change History
   ==============
   DATE          VERSION    PROGRAMMERS        NOTES
   ----------    -------    -----------------  ----------------------
   22 Nov 2010    0000      James Ward         Initial implementation
******************************************************************************/

void check_gauge_lat_lon(void)
{
   int   i, j;
   char  site[NUM_SITE_CHARS+1];
   float lat_f, lon_f;
   float azm, rng, rng_nm;
   int   azm_int, rng_dp, rng_pps;
   float x, y;
   int   x_int, y_int;
   int   num_chars = 0;
   /* int   found_it; */

   /* radar locations, for debug
    *
    * fprintf(stderr, "KOUN lat %f lon %f\n",
    *         35 + (14 / 60.0) + ( 9.81 / 3600.0),
    *        -97 - (27 / 60.0) - (44.46 / 3600.0));
    *
    * fprintf(stderr, "KTLX lat %f lon %f\n",
    *         35 + (19 / 60.0) + (59    / 3600.0),
    *        -97 - (16 / 60.0) - (39.94 / 3600.0));
    *
    * fprintf(stderr, "KCRI lat %f lon %f\n",
    *         35 + (14 / 60.0) + (18 / 3600.0),
    *        -97 - (27 / 60.0) - (36 / 3600.0)); */

   /* In cvg:
    *
    * azm   0.0 <= radial   1 < azm   1.0
    * azm   1.0 <= radial   2 < azm   2.0
    * ...
    * azm 359.0 <= radial 360 < azm 360.0 */

   for(i=0; i<num_gauges; i++)
   {
      memset(site,  0, NUM_SITE_CHARS+1);

      strncpy(site, &(gauges[i].id[0]), NUM_SITE_CHARS);

      lat_f = gauges[i].lat;
      lon_f = gauges[i].lon;

      RPGCS_latlon_to_azran(lat_f, lon_f, &rng, &azm);

      azm_int = (int) azm;

      while(azm_int < 0)
      {
         fprintf(stderr, "+++++++++++++++++++++++++\n");
         azm_int += 360;
      }
      while(azm_int > 359)
      {
         fprintf(stderr, "-------------------------\n");
         azm_int -= 360;
      }

      rng_nm = rng * KM_TO_NM;

      rng_pps = (int) (rng / 2.0); /*   2 km */
      rng_dp  = (int) (rng * 4.0); /* 1/4 km */

      RPGCS_latlon_to_xy(lat_f, lon_f, &x, &y);

      x_int = RPGC_NINT(x * 4.0); /* 1/4 km */
      y_int = RPGC_NINT(y * 4.0); /* 1/4 km */

      num_chars = 0;

      fprintf(stderr, "%3.3d) ", i);

      for(j=0; j<NUM_SITE_CHARS; j++)
      {
         if(site[j] == ' ')
         {
            /* do nothing */
         }
         else
         {
            fprintf(stderr, "%c", site[j]);
            num_chars++;
         }
      }

      for(j=num_chars; j<NUM_SITE_CHARS; j++)
         fprintf(stderr, " ");

      fprintf(stderr,
              "(%f, %f) -> (azm %f, %f km = %f nm)",
              lat_f, lon_f,
              azm,     rng,     rng_nm);

      fprintf(stderr,
              " -> (azm %d, pps_bin %d, dp_bin %d)",
              azm_int, rng_pps, rng_dp);

      fprintf(stderr,
              " -> (x %d, y %d)",
              x_int, y_int);

      /* The following  only works if the radar is KOUN
       * Locate the gauge in the database

      found_it = FALSE;

      for(j=0; j<KOUN_GAUGES; j++)
      {
         if(strstr(site, koun_gauge_name[j]) != NULL)
         {
            found_it = TRUE;
            break;
         }
      }

      if(rng_dp < 920)
      {
         fprintf(stderr, "-> under the %s umbrella, ",
                 site_adapt.rpg_name);

         if(found_it == TRUE)
         {
            fprintf(stderr, "is in database at index %d, ", j);

            if((fabsf(azm - koun_gauge_azm[j]) < 0.000001) &&
               (azm_int == koun_gauge_azm_i[j])            &&
               (rng_pps == koun_gauge_pps_bin[j])          &&
               (rng_dp  == koun_gauge_dp_bin[j])           &&
               (x_int   == koun_gauge_x[j])                &&
               (y_int   == koun_gauge_y[j]))
            {
               fprintf(stderr,
               "with correct (azm, azm_i, pps_bin, dp_bin, gauge_x, gauge_y)");
            }
            else
            {
               fprintf(stderr,
               "ERROR (%f, %d, %d, %d, %d, %d) != (%f, %d, %d, %d, %d, %d)",
               azm,              azm_int,
               rng_pps,          rng_dp,
               x_int,            y_int,
               koun_gauge_azm[j],     koun_gauge_azm_i[j],
               koun_gauge_pps_bin[j], koun_gauge_dp_bin[j],
               koun_gauge_x[j],       koun_gauge_y[j]);
            }
         }
         else
         {
            fprintf(stderr, "ERROR not in database!!!");
         }
      }
      else
      {
         fprintf(stderr, "-> not under the %s umbrella, ",
                 site_adapt.rpg_name);

         if(found_it == TRUE)
         {
            fprintf(stderr, "ERROR is in database at index %d, ", j);
         }
         else
         {
            fprintf(stderr, "not in database");
         }

      }
      */
      fprintf(stderr, "\n");
   }

   /* For printing out other gauge values ...

   for(i=0; i<KOUN_GAUGES; i++)
   {
       RPGCS_latlon_to_azran(gauge_lat[i], gauge_lon[i], &rng, &azm);
       RPGCS_latlon_to_xy(gauge_lat[i], gauge_lon[i], &x, &y);

       y_int = RPGC_NINT(4.0 * y); -* 1/4 km *-

       if(y_int >= 0)
          fprintf(stderr, " ");
       if(abs(y_int) < 100)
          fprintf(stderr, " ");
       if(abs(y_int) < 10)
          fprintf(stderr, " ");
       fprintf(stderr, " %d,", y_int);
       if((i+1) % 5 == 0)
          fprintf(stderr, "\n");
    }
    fprintf(stderr, "};\n");
    */

    /* Calculate feature locations

    RPGCS_latlon_to_xy(35.333056, -97.277761, &x, &y);
    x_int = RPGC_NINT(4.0 * x);
    y_int = RPGC_NINT(4.0 * y);
    fprintf(stderr, "KTLX %d, %d \n", x_int, y_int);

    RPGCS_latlon_to_xy(35.238333, -97.460000, &x, &y);
    x_int = RPGC_NINT(4.0 * x);
    y_int = RPGC_NINT(4.0 * y);
    fprintf(stderr, "KCRI %d, %d \n", x_int, y_int);

    * Weatherford Wind Energy Center:
    * http://www.thewindpower.net/wind-farm-map-3117-\
    *        weatherford-wind-energy-center--.php
    *
    * Blue Canyon was from 6/14/2010 Mark Fresch email.
    *
    * This site had co-ordinates, BUT were (bad) defaults for all farms:
    * http://en.openei.org/wiki/Weatherford_Wind_Energy_Center
    *
    * This site gave Lawton as the location of Blue Canyon/Blue Canyon II:
    * http://www.thewindpower.net/wind-farm-map-3116.php
    * http://www.thewindpower.net/wind-farm-map-3118.php */

    RPGCS_latlon_to_xy( 35 + (31 / 60.0) + ( 48 / 3600.0),
                       -98 - (42 / 60.0) - (  0 / 3600.0), &x, &y);
    x_int = RPGC_NINT(4.0 * x);
    y_int = RPGC_NINT(4.0 * y);
    fprintf(stderr, "WEATHERFORD %d, %d\n", x_int, y_int);

    RPGCS_latlon_to_xy( 34 + (48.2 / 60.0) + (0 / 3600.0),
                       -98 - (37.5 / 60.0) - (0 / 3600.0), &x, &y);
    x_int = RPGC_NINT(4.0 * x);
    y_int = RPGC_NINT(4.0 * y);
    fprintf(stderr, "BLUE CANYON %d, %d\n", x_int, y_int);

    /* For reading a Julian date
    int julian, year, month, day;
    julian = 14774;
    RPGCS_julian_to_date(julian, &year, &month, &day);
    fprintf(stderr, "%d = %4d%2d%2d\n", julian, year, month, day);
    */

} /* end check_gauge_lat_lon() ================================== */

/******************************************************************************
   Function name: read_gauges()

   Description:
   ============
     Reads in the gauges from ~/src/cpc102/tsk022/SITE_gauges

   Inputs:

     None.

   Outputs:

     Gauges read in.

   Return:

      None.

   Called by: main()

   Change History
   ==============
   DATE          VERSION    PROGRAMMERS        NOTES
   -----------   -------    -----------------  ----------------------
   22 Nov 2010    0000      James Ward         Initial implementation
   03 Mar 2011    0001      James Ward         Added immediate abort if could
                                               not open gauge file.
******************************************************************************/

void read_gauges(void)
{
   char line[MAX_LINE_LEN]; /* one line of gauge data */

   char  id[MAX_LINE_LEN];   /* CSV id  */
   char  lat[MAX_LINE_LEN];  /* CSV lat */
   char  lon[MAX_LINE_LEN];  /* CSV lon */
   char* token = NULL;

   float x, y;
   FILE* fp = NULL;

   char gauge_file[80];

   /* Build the path to the gauge file */

   strcpy(gauge_file, getenv("HOME"));
   strcat(gauge_file, "/src/cpc102/tsk022/");
   strncat(gauge_file, site_adapt.rpg_name, 4);
   strcat(gauge_file, "_");
   strcat(gauge_file, "gauges");

   fp = fopen(gauge_file, "r");

   if(fp == NULL)
   {
      RPGC_log_msg(GL_INFO, "Could not open %s, aborting.\n", gauge_file);

      /* Abort, so user knows immediately something
       * is wrong. */

      RPGC_abort_task();
      return;
   }

   /* Read in the gauges */

   memset(line, 0, MAX_LINE_LEN);

   memset(gauges, 0, sizeof(Gauge) * MAX_GAUGES);

   while(fgets(line, MAX_LINE_LEN, fp) != NULL)
   {
      /* printf("|%s|\n", line); */

      /* Ignore lines that start with '#' */

      if(line[0] == '#')
         continue;

      memset(id,  0, MAX_LINE_LEN);
      memset(lat, 0, MAX_LINE_LEN);
      memset(lon, 0, MAX_LINE_LEN);

      /* Tokenize on the comma */

      token = strtok(line, ",");
      if(token != NULL)
      {
         strcpy(id, token);
         strcpy(gauges[num_gauges].id, id);
      }

      token = strtok(NULL, ",");
      if(token != NULL)
      {
         strcpy(lat, token);
         gauges[num_gauges].lat = atof(lat);
      }

      token = strtok(NULL, ",");
      if(token != NULL)
      {
         strcpy(lon, token);
         gauges[num_gauges].lon = atof(lon);
      }

      /* Convert to km, azm */

      RPGCS_latlon_to_azran(gauges[num_gauges].lat,
                            gauges[num_gauges].lon,
                            &(gauges[num_gauges].km),
                            &(gauges[num_gauges].azm));

      gauges[num_gauges].azm_s =
         (short) gauges[num_gauges].azm;

      /* Correct azimuth boundary */

      while(gauges[num_gauges].azm_s < 0)
      {
         gauges[num_gauges].azm_s += 360;
      }
      while(gauges[num_gauges].azm_s > 359)
      {
         gauges[num_gauges].azm_s -= 360;
      }

      /* rng_nm = gauges[num_gauges].km * KM_TO_NM; */

      gauges[num_gauges].pps_bin =
         (short) (gauges[num_gauges].km / 2.0); /*   2 km */

      gauges[num_gauges].dp_bin =
         (short) (gauges[num_gauges].km * 4.0); /* 1/4 km */


      RPGCS_latlon_to_xy(gauges[num_gauges].lat,
                         gauges[num_gauges].lon,
                         &x, &y);

      gauges[num_gauges].x =
         (short) RPGC_NINT(x * 4.0); /* 1/4 km */

      gauges[num_gauges].y =
         (short) RPGC_NINT(y * 4.0); /* 1/4 km */

      num_gauges++;

     if(num_gauges == MAX_GAUGES)
        break;

      memset(line, 0, MAX_LINE_LEN);
   }

   fclose(fp);

   RPGC_log_msg(GL_INFO, "        num_gauges: %hd\n", num_gauges);

   if(num_gauges < 1)
   {
      RPGC_log_msg(GL_INFO, "No gauges, aborting.\n", num_gauges);

      /* Abort, so user knows immediately something
      * is wrong. */

      RPGC_abort_task();
   }

} /* end read_gauges() ================================== */

/******************************************************************************
   Function name: print_gauges()

   Description:
   ============
     Prints the gauges, for debugging

   Inputs:

     None.

   Outputs:

     Gauges printed.

   Return:

      None.

   Change History
   ==============
   DATE          VERSION    PROGRAMMERS        NOTES
   -----------   -------    -----------------  ----------------------
   14 Jan 2010    0000      James Ward         Initial implementation
******************************************************************************/

void print_gauges(void)
{
   short i;

   for(i=0; i<num_gauges; i++)
   {
      fprintf(stderr, "---------- %d ----------\n", i);
      fprintf(stderr, "     id: %s\n", gauges[i].id);
      fprintf(stderr, "    lat: %f\n", gauges[i].lat);
      fprintf(stderr, "    lon: %f\n", gauges[i].lon);
      fprintf(stderr, "     km: %f\n", gauges[i].km);
      fprintf(stderr, "    azm: %f\n", gauges[i].azm);
      fprintf(stderr, "  azm_s: %d\n", gauges[i].azm_s);
      fprintf(stderr, " dp_bin: %d",   gauges[i].dp_bin);

      if(gauges[i].dp_bin < 8)
      {
         fprintf(stderr, " -> ERROR %s is too close to the %s radar",
                gauges[i].id, site_adapt.rpg_name);
      }
      else if(gauges[i].dp_bin > 919)
      {
         fprintf(stderr, " -> ERROR %s is not under the %s umbrella",
                gauges[i].id, site_adapt.rpg_name);
      }
      fprintf(stderr, "\n");

      fprintf(stderr, "pps_bin: %d\n", gauges[i].pps_bin);
      fprintf(stderr, "      x: %d\n", gauges[i].x);
      fprintf(stderr, "      y: %d\n", gauges[i].y);
   }

} /* end print_gauges() ================================== */
